# 5 测试

## 5.1 部署
在进行测试之前，首先需要部署整个系统环境。以下将按步骤叙述从打包、初始化到使用Docker Compose启动所有服务的过程。

### 5.1.1 环境准备与打包
确保本地环境已安装JDK 21、Node.js 20和Docker 24以上版本。
进入项目根目录，运行 `build.sh` 脚本以编译并打包后端Java应用和前端资源。

### 5.1.2 环境初始化
同样在项目根目录下，运行 `init.sh` 脚本，该脚本可能包含了设置Docker相关环境变量或其他初始化操作。

在 `~/appconfig/` 目录下的各个服务配置文件中，需要根据实际情况填充相应的配置项，例如：
- service-sms服务需要配置阿里云短信服务的endpoint、access-key-id、access-key-secret等信息。
- service-oss服务需要配置阿里云OSS的相关参数，如endpoint、access-key-id、access-key-secret以及bucket名称。
- service-order服务需配置支付宝支付网关、应用ID、私钥、公钥和站点域名等支付相关参数。

### 5.1.3 镜像构建
使用Docker Compose v1.29及以上版本，运行 `docker-compose build` 命令构建项目中所有服务的Docker镜像。

### 5.1.4 启动服务
使用 `docker-compose up -d` 命令启动所有服务容器，并以守护态模式运行。

<!--
- **基础设施服务**：
    
    - Nacos：作为注册中心和配置中心运行在8848、9848、9849端口。
    - MySQL：配置了root用户的初始密码，并挂载了初始化SQL脚本、配置文件、日志目录等卷。
    - MongoDB：设置了初始化用户名和密码，并挂载了数据、配置、备份等目录。
    - Redis：挂载了数据目录、配置文件，并开启了AOF持久化和设置了密码保护。
    - RabbitMQ：设置了默认用户和密码，并暴露了AMQP和管理端口。
- **应用服务**：
    
    - 多个微服务（如服务网关、医院服务、用户服务等）均通过Dockerfile构建镜像，并使用环境变量和卷挂载的方式注入配置信息。
    - 前端应用（如网站前端和后台管理界面）也通过Dockerfile构建镜像，并映射端口对外提供服务。
-->


## 5.2 后台管理测试

### 5.2.1 后台管理员登录、登出
| 测试项                                                 | 测试结果 |
| ------------------------------------------------------ | -------- |
| 测试管理员能否通过正确的账号密码登录系统。             | 通过     |
| 测试错误的账号密码组合是否被拒绝登录，并显示相应提示。 | 通过     |
| 测试管理员登出功能是否正常，登出后是否回到登录页面。   | 通过     |

### 5.2.2 后台管理首页数据展示
| 测试项                                                                       | 测试结果 |
| ---------------------------------------------------------------------------- | -------- |
| 测试首页是否能展示预期的各项数据统计，包括但不限于用户数、医院数、订单数等。 | 通过     |
| 测试数据是否实时更新。                                                       | 通过     |

### 5.2.3 数据字典展示、导入导出
| 测试项                                                          | 测试结果 |
| --------------------------------------------------------------- | -------- |
| 测试数据字典项是否能正确展示。                                  | 通过     |
| 测试导入功能是否能正确读取Excel文件，并更新数据字典。           | 通过     |
| 测试导出功能是否能正确生成并下载包含所有数据字典项的Excel文件。 | 通过     |

### 5.2.4 医院管理增删改查，状态变更
| 测试项                                            | 测试结果 |
| ------------------------------------------------- | -------- |
| 测试是否能成功添加、编辑、删除医院信息。          | 通过     |
| 测试医院信息查询功能是否能准确返回搜索结果。      | 通过     |
| 测试医院状态变更功能（如启用/禁用）是否正常工作。 | 通过     |

### 5.2.5 用户管理增删改查，状态变更
| 测试项                                            | 测试结果 |
| ------------------------------------------------- | -------- |
| 测试是否能成功添加、编辑、删除用户信息。          | 通过     |
| 测试用户信息查询功能是否能准确返回搜索结果。      | 通过     |
| 测试用户状态变更功能（如启用/禁用）是否正常工作。 | 通过     |

### 5.2.6 文件上传、下载、删除
| 测试项                                                     | 测试结果 |
| ---------------------------------------------------------- | -------- |
| 测试文件上传功能是否支持各种格式文件，并正确保存到服务器。 | 通过     |
| 测试文件下载功能是否能正确提供下载链接，并保持文件完整性。 | 通过     |
| 测试文件删除功能是否能从服务器删除指定文件。               | 通过     |

### 5.2.7 订单管理增删改查，状态变更
| 测试项                                                 | 测试结果 |
| ------------------------------------------------------ | -------- |
| 测试是否能成功创建、编辑、删除订单。                   | 通过     |
| 测试订单查询功能是否能准确返回搜索结果。               | 通过     |
| 测试订单状态变更功能（如已支付、已取消）是否正常工作。 | 通过     |

### 5.2.8 定时任务：发送就诊通知、更新订单状态
| 测试项                                 | 测试结果 |
| -------------------------------------- | -------- |
| 测试系统是否能定时发送就诊通知给用户。 | 通过     |
| 测试系统是否能定时更新订单状态。       | 通过     |

### 5.2.9 查看统计分析数据（医院、用户、订单）
| 测试项                                                     | 测试结果 |
| ---------------------------------------------------------- | -------- |
| 测试统计分析页面是否能正确显示医院、用户、订单的统计数据。 | 通过     |
| 测试各项数据是否能按预期的条件进行筛选和分析。             | 通过     |


## 5.3 前台门户测试

### 5.3.1 前台用户登录（手机验证码、微信扫码）、登出
| 测试项                                                   | 测试结果 |
| -------------------------------------------------------- | -------- |
| 测试用户能否通过手机验证码登录系统。                     | 通过     |
| 测试微信扫码登录功能是否正常，包括扫码、授权、登录流程。 | 通过     |
| 测试用户登出功能是否正常，登出后是否回到登录页面。       | 通过     |

### 5.3.2 医院列表展示、按等级、地区、名称查询
| 测试项                                               | 测试结果 |
| ---------------------------------------------------- | -------- |
| 测试医院列表是否能正确展示所有医院信息。             | 通过     |
| 测试列表是否支持按医院等级、地区、名称进行筛选查询。 | 通过     |

### 5.3.3 医院科室、详情展示
| 测试项                                                         | 测试结果 |
| -------------------------------------------------------------- | -------- |
| 测试选定医院后是否能正确显示该医院的所有科室信息。             | 通过     |
| 测试医院详情页面是否包含完整的医院信息，包括地址、联系方式等。 | 通过     |

### 5.3.4 科室排班信息展示
| 测试项                                                               | 测试结果 |
| -------------------------------------------------------------------- | -------- |
| 测试选定科室后是否能正确显示该科室的排班信息，包括医生、排班时间等。 | 通过     |

### 5.3.5 预约挂号、创建订单、支付、取消订单
| 测试项                                                 | 测试结果 |
| ------------------------------------------------------ | -------- |
| 测试用户能否成功进行挂号预约，并创建订单。             | 通过     |
| 测试支付功能是否正常，包括支付流程和支付状态更新。     | 通过     |
| 测试用户能否在规定条件下取消订单，并正确更新订单状态。 | 通过     |

### 5.3.6 查看、修改个人信息，实名认证
| 测试项                                                     | 测试结果 |
| ---------------------------------------------------------- | -------- |
| 测试用户能否查看自己的个人信息。                           | 通过     |
| 测试用户能否更新自己的个人信息，包括昵称、手机号等。       | 通过     |
| 测试实名认证功能是否正常，包括提交实名信息和认证状态更新。 | 通过     |

### 5.3.7 就诊人管理，增删改查
| 测试项                                       | 测试结果 |
| -------------------------------------------- | -------- |
| 测试用户能否成功添加、编辑、删除就诊人信息。 | 通过     |
| 测试用户能否查询到已添加的就诊人信息列表。   | 通过     |

### 5.3.8 用户讨论区
| 测试项                                 | 测试结果 |
| -------------------------------------- | -------- |
| 测试用户能否在讨论区发帖、回帖。       | 通过     |
| 测试帖子和回复是否按时间顺序正确显示。 | 通过     |
